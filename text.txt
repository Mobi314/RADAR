Current Quarter = 
VAR SelectedDate = SELECTEDVALUE('Table'[Date])
VAR FiscalYearStart = DATE(YEAR(SelectedDate) - (MONTH(SelectedDate) < 4), 4, 1)  // Fiscal year starts on April 1st
VAR Q1Start = FiscalYearStart
VAR Q2Start = DATE(YEAR(FiscalYearStart), 7, 1)
VAR Q3Start = DATE(YEAR(FiscalYearStart), 10, 1)
VAR Q4Start = DATE(YEAR(FiscalYearStart) + 1, 1, 1)
RETURN
    SWITCH(TRUE(),
        SelectedDate < Q2Start, "Q1",
        SelectedDate < Q3Start, "Q2",
        SelectedDate < Q4Start, "Q3",
        "Q4"
    )

Current Quarter Start = 
VAR CurrentQ = [Current Quarter]
VAR FiscalYearStart = DATE(YEAR(TODAY()) - (MONTH(TODAY()) < 4), 4, 1)
RETURN
    SWITCH(CurrentQ,
        "Q1", FiscalYearStart,
        "Q2", DATE(YEAR(FiscalYearStart), 7, 1),
        "Q3", DATE(YEAR(FiscalYearStart), 10, 1),
        "Q4", DATE(YEAR(FiscalYearStart) + 1, 1, 1)
    )

Current Quarter End = 
VAR CurrentQ = [Current Quarter]
VAR FiscalYearStart = DATE(YEAR(TODAY()) - (MONTH(TODAY()) < 4), 4, 1)
RETURN
    SWITCH(CurrentQ,
        "Q1", DATE(YEAR(FiscalYearStart), 6, 30),
        "Q2", DATE(YEAR(FiscalYearStart), 9, 30),
        "Q3", DATE(YEAR(FiscalYearStart), 12, 31),
        "Q4", DATE(YEAR(FiscalYearStart) + 1, 3, 31)
    )

Next Quarter = 
SWITCH([Current Quarter],
    "Q1", "Q2",
    "Q2", "Q3",
    "Q3", "Q4",
    "Q4", "Q1"
)

Programs Due at Start of Current Quarter = 
CALCULATE(
    DISTINCTCOUNT('Table'[Program JIRA Key]),
    FILTER('Table',
        (ISBLANK('Table'[Program End Date]) && 'Table'[Program Baseline End Date] <= [Current Quarter Start]) ||
        ('Table'[Program End Date] <= [Current Quarter Start]) &&
        NOT('Table'[Program Status] IN {"Open", "IN REVIEW", "Closed"}) &&
        NOT('Table'[Program Status2] IN {"Open", "IN REVIEW", "Closed"})
    )
)

Programs Due at End of Current Quarter = 
CALCULATE(
    DISTINCTCOUNT('Table'[Program JIRA Key]),
    FILTER('Table',
        (NOT(ISBLANK('Table'[Program End Date])) && 'Table'[Program End Date] <= [Current Quarter End] &&
        'Table'[Program End Date] > [Current Quarter Start]) ||
        (ISBLANK('Table'[Program End Date]) && 'Table'[Program Baseline End Date] <= [Current Quarter End] &&
        'Table'[Program Baseline End Date] > [Current Quarter Start]) &&
        NOT('Table'[Program Status] IN {"Open", "IN REVIEW", "Closed"}) &&
        NOT('Table'[Program Status2] IN {"Open", "IN REVIEW", "Closed"})
    )
)

Programs Due Next Quarter = 
VAR NextQuarterStart = 
    SWITCH([Current Quarter],
        "Q1", DATE(YEAR('Table'[Date]), 7, 1),
        "Q2", DATE(YEAR('Table'[Date]), 10, 1),
        "Q3", DATE(YEAR('Table'[Date])+1, 1, 1),
        "Q4", DATE(YEAR('Table'[Date])+1, 4, 1)
    )
VAR NextQuarterEnd = 
    SWITCH([Next Quarter],
        "Q1", DATE(YEAR(NextQuarterStart), 6, 30),
        "Q2", DATE(YEAR(NextQuarterStart), 9, 30),
        "Q3", DATE(YEAR(NextQuarterStart), 12, 31),
        "Q4", DATE(YEAR(NextQuarterStart), 3, 31)
    )
RETURN
CALCULATE(
    DISTINCTCOUNT('Table'[Program JIRA Key]),
    FILTER('Table',
        (NOT(ISBLANK('Table'[Program End Date])) && 'Table'[Program End Date] >= NextQuarterStart && 'Table'[Program End Date] <= NextQuarterEnd ||
         ISBLANK('Table'[Program End Date]) && 'Table'[Program Baseline End Date] >= NextQuarterStart && 'Table'[Program Baseline End Date] <= NextQuarterEnd) &&
        NOT('Table'[Program Status] IN {"Open", "IN REVIEW", "Closed"}) &&
        NOT('Table'[Program Status2] IN {"Open", "IN REVIEW", "Closed"})
    )
)

Business Outcomes Due at Start of Current Quarter = 
CALCULATE(
    DISTINCTCOUNT('Table'[Business Outcome JIRA Key]),
    FILTER('Table',
        ISBLANK('Table'[Business Outcome End Date]) && 'Table'[Business Outcome Baseline End Date Formatted] <= STARTOFQUARTER('Table'[Date]) ||
        'Table'[Business Outcome End Date] <= STARTOFQUARTER('Table'[Date]) &&
        NOT('Table'[Business Outcome Status] IN {"Open", "IN REVIEW", "Closed"}) &&
        NOT('Table'[Business Outcome Status2] IN {"Open", "IN REVIEW", "Closed"})
    )
)

Business Outcomes Due at End of Current Quarter = 
CALCULATE(
    DISTINCTCOUNT('Table'[Business Outcome JIRA Key]),
    FILTER('Table',
        (NOT(ISBLANK('Table'[Business Outcome End Date])) && 'Table'[Business Outcome End Date] <= ENDOFQUARTER('Table'[Date]) ||
         ISBLANK('Table'[Business Outcome End Date]) && 'Table'[Business Outcome Baseline End Date Formatted] <= ENDOFQUARTER('Table'[Date])) &&
        'Table'[Business Outcome End Date] > STARTOFQUARTER('Table'[Date]) &&
        NOT('Table'[Business Outcome Status] IN {"Open", "IN REVIEW", "Closed"}) &&
        NOT('Table'[Business Outcome Status2] IN {"Open", "IN REVIEW", "Closed"})
    )
)

Business Outcomes Due Next Quarter = 
VAR NextQuarterStart = 
    SWITCH([Current Quarter],
        "Q1", DATE(YEAR('Table'[Date]), 7, 1),
        "Q2", DATE(YEAR('Table'[Date]), 10, 1),
        "Q3", DATE(YEAR('Table'[Date])+1, 1, 1),
        "Q4", DATE(YEAR('Table'[Date])+1, 4, 1)
    )
VAR NextQuarterEnd = 
    SWITCH([Next Quarter],
        "Q1", DATE(YEAR(NextQuarterStart), 6, 30),
        "Q2", DATE(YEAR(NextQuarterStart), 9, 30),
        "Q3", DATE(YEAR(NextQuarterStart), 12, 31),
        "Q4", DATE(YEAR(NextQuarterStart), 3, 31)
    )
RETURN
CALCULATE(
    DISTINCTCOUNT('Table'[Business Outcome JIRA Key]),
    FILTER('Table',
        (NOT(ISBLANK('Table'[Business Outcome Actual End Date Formatted])) && 'Table'[Business Outcome Actual End Date Formatted] >= NextQuarterStart && 'Table'[Business Outcome Actual End Date Formatted] <= NextQuarterEnd ||
         ISBLANK('Table'[Business Outcome Actual End Date Formatted]) && 'Table'[Business Outcome Baseline End Date Formatted] >= NextQuarterStart && 'Table'[Business Outcome Baseline End Date Formatted] <= NextQuarterEnd) &&
        NOT('Table'[Business Outcome Status] IN {"Open", "IN REVIEW", "Closed"}) &&
        NOT('Table'[Business Outcome Status2] IN {"Open", "IN REVIEW", "Closed"})
    )
)
